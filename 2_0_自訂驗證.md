#### MVC架構下的驗證-回傳請求的url網頁
此處以MVC的架構自訂驗證，不論是驗證或驗證通過後，都直接回傳一個jsp網頁，之後會再新增適用於Restful server的驗證-「JSON Web Token」（JWT）。
為了讓server可以讓jsp渲染網頁，需要在pom.xml底下新增tomcat-embed-jasper，它的作用是編譯jsp並使其渲染到瀏覽器上，若沒有添加，會讓server端直接回傳一個jsp檔案給client下載。
```xml
<!-- required for JSP compilation -->
	<dependency>
		<groupId>org.apache.tomcat.embed</groupId>
		<artifactId>tomcat-embed-jasper</artifactId>
		<scope>provided</scope>
	</dependency>
```

#### WebSecurityConfigurerAdapter介紹
在01_環境建置章節中，使用的是default的設定，只要是任何發送給spring boot的請求都會需要驗證，若想自訂需要被驗證的url則需要宣告一個繼承org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter的類別。


WebSecurityConfigurerAdapter 為abstract class，裡頭有許多可視為default method行為的方法，如設定需要被驗證的url方法:configure(HttpSecurity http)，以下為該方法的原始碼，如同其註解所解釋，若需要自訂，只需要override即可。
```java
    /**
	 * Override this method to configure the {@link HttpSecurity}. Typically subclasses
	 * should not invoke this method by calling super as it may override their
	 * configuration. The default configuration is:
	 *
	 * <pre>
	 * http.authorizeRequests().anyRequest().authenticated().and().formLogin().and().httpBasic();
	 * </pre>
	 *
	 * Any endpoint that requires defense against common vulnerabilities can be specified
	 * here, including public ones. See {@link HttpSecurity#authorizeRequests} and the
	 * `permitAll()` authorization rule for more details on public endpoints.
	 * @param http the {@link HttpSecurity} to modify
	 * @throws Exception if an error occurs
	 */
	protected void configure(HttpSecurity http) throws Exception {
		this.logger.debug("Using default configure(HttpSecurity). "
				+ "If subclassed this will potentially override subclass configure(HttpSecurity).");
		http.authorizeRequests((requests) -> requests.anyRequest().authenticated());
		http.formLogin();
		http.httpBasic();
	}

```
#### 自訂驗證實作

**1. 覆寫WebSecurityConfigurerAdapter中的configure(HttpSecurity http)**
```java
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {

	// 設定需要驗證的url
//	@Override
//	protected void configure(HttpSecurity http) throws Exception {
//		
//		
//		http.authorizeRequests().antMatchers(HttpMethod.GET, "/users/**").authenticated().antMatchers(HttpMethod.GET)
//				.permitAll().antMatchers(HttpMethod.POST, "/users").permitAll().anyRequest().authenticated().and()
//				.csrf().disable().formLogin();
//	}

	// 設定使用者帳號、密碼和角色
//	@Override
//	protected void configure(AuthenticationManagerBuilder auth) throws Exception {
//
//		UserBuilder user = User.withDefaultPasswordEncoder();
//
//		auth.inMemoryAuthentication().withUser(user.username("test1").password("123").roles("ADMIN"));
//
//	}

}

```








<!-- jwt 補充資
https://chikuwa-tech-study.blogspot.com/2021/06/spring-boot-username-password-authentication-and-jwt.html
 -->